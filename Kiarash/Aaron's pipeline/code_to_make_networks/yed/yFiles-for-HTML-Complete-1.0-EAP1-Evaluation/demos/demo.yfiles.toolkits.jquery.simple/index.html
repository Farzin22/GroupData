<!DOCTYPE html>
<html>
<!-- ////////////////////////////////////////////////////////////////////////
     //
     // This file is part of yFiles for HTML 1.0-EAP1.
     // 
     // yWorks proprietary/confidential. Use is subject to license terms.
     //
     // Redistribution of this file or of an unauthorized byte-code version
     // of this file is strictly forbidden.
     //
     // Copyright (c) 2012 by yWorks GmbH, Vor dem Kreuzberg 28, 
     // 72070 Tuebingen, Germany. All rights reserved.
     // 
     ////////////////////////////////////////////////////////////////////////-->

	<head>
		<title>jQuery integration demo</title>
		<link rel="stylesheet" href="../resources/style/graphclient.css"/>
		<link rel="stylesheet" href="../resources/style/yfiles-app-framework.css"/>
		<link rel="stylesheet" href="style/style.css"/>
		<script src="../../lib/yfiles/es5-shim.js"></script>
    <script src="../../lib/yfiles/lang.js"></script>
    <script src="../resources/license.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script>
      var yfiles = yfiles ? yfiles : {};
      yfiles.baseUrl = "../../lib/";
    </script>
		<script src="../../lib/yfiles/complete.js"></script>
		<script src="js/GraphControl.js"></script>
		<script src="../resources/license.js"></script>
		<script>
			// helper function to make a new button
			function makeButton(iconClass, clickHandler) {
				return $('<button class="y-button"><span class="yIconSmall '+iconClass+'"></span></button>').click(clickHandler);
			}

			yfiles.ready([],function() { // wait until the yfiles library is completely loaded
        // replace the children of every element that has a "graphControl" class with an actual graph control.
        $('.graphControl').GraphControl(function(graphControl) {
          var $this = $(this);
          // add the overlay mini toolbar
          var miniToolbar = $('<div class="y-toolbar mini-toolbar"></div>');
          miniToolbar.append(makeButton('yIconZoomIn', function() {
            graphControl.zoom = graphControl.zoom * 1.2;
          })).append(makeButton('yIconZoomOut', function() {
            graphControl.zoom = graphControl.zoom / 1.2;
          })).append(makeButton('yIconZoomOriginal', function() {
            graphControl.zoom = 1;
          })).append(makeButton('yIconZoomFit', function() {
            graphControl.fitContent();
          }));
          if($this.attr('data-ylayout') == 'GenericTree') {
            var layouter = new yworks.yfiles.layout.tree.GenericTreeLayouter();
              layouter.prependStage(new yworks.yfiles.layout.FixNodeLayoutStage());
              var runningLayout = false;
            miniToolbar.append(makeButton('yIconLayout', function() {
              if(runningLayout) return;

              runningLayout = true;
                  var layoutExecutor = new yworks.yfiles.ui.model.LayoutExecutor.FromControlAndLayouter(graphControl, layouter);
                  layoutExecutor.updateContentRect = true;
                  layoutExecutor.animateViewport = true;
                  layoutExecutor.duration = yfiles.system.TimeSpan.fromSeconds(0.3);
                  layoutExecutor.finishHandler = function() { runningLayout = false; };
                  layoutExecutor.start();
            }));
          }
          // show the toolbar on hover using jQuery
          $this.prepend(miniToolbar).hover(function() {
            miniToolbar.addClass('visible');
          }, function() {
            miniToolbar.removeClass('visible');
          });
        });
			});
		</script>
	</head>
	<body>
		<div id="page">
			<h1>jQuery integration demo</h1>
			<div class="graphBox">
				<p>This graph control is editable and uses an orthogonal edge creation mode.</p>
				<div class="graphControl" data-ylayout="GenericTree" data-yNodeStyle="ShinyPlateNodeStyle" data-yCreateEdgeMode="orthogonal">
					<p>(show graph as an image instead)</p>
				</div>
			</div>
			<div class="graphBox">
				<p>This graph control is not editable and displays a sample graph.</p>
				<div class="graphControl" data-yNodeStyle="ShinyPlateNodeStyle" data-yEditMode="GraphViewer"
						data-yGraphMLSource="resources/family-tree.graphml">
					<p>Please wait while we load the graph.</p>
				</div>
			</div>
			<div id="description">
				<h2>Description</h2>
				<p>This demo shows how you can add <strong>GraphControl</strong>s to a website using <a href="http://www.jquery.com">jQuery</a>. It is possible to test if <em>yFiles for HTML</em> is
					probably supported by the visitor of the website and then replace static images of a graph with a fully interactive graph, following
					<a href="http://www.jquery.com">jQuery</a>s principle of progressive enhancement.</p>
			</div>
		</div>
	</body>
</html>